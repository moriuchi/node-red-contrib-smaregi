<script type="text/x-red" data-help-name="smaregi-stock">
  <p>スマレジ・プラットフォームAPIを使用して、<code>Operation</code>で選択した以下の処理を実行します。</p>
  <ul>
    <li>在庫一覧取得</li>
    <li>在庫更新</li>
    <li>在庫相対値更新</li>
    <li>在庫一括相対値更新</li>
    <li>在庫変動履歴取得</li>
  </ul>

  <h3>入力</h3>
    <dl class="message-properties">
        <dt>商品 ID <span class="property-type">文字列</span></dt>
        <dd>選択した処理を実行する商品IDを入力します。</dd>
        <dt>店舗 ID <span class="property-type">文字列</span></dt>
        <dd>選択した処理を実行する店舗IDを入力します。</dd>
        <dt>在庫数 <span class="property-type">文字列</span></dt>
        <dd>選択した処理を実行する在庫数を入力します。</dd>
        <dt>Limit <span class="property-type">数値</span></dt>
        <dd>一覧取得時に一度に返すアイテム数を1 〜 1000の範囲で入力します。</dd>
        <dt>Page <span class="property-type">数値</span></dt>
        <dd>一覧取得時に取得する対象ページを入力します。</dd>
        <dt>stocks <span class="property-type">文字列 | 配列</span></dt>
        <dd>一括更新する在庫情報の配列を入力します。</dd>
        <dt>完了通知URL <span class="property-type">文字列</span></dt>
        <dd>在庫一括相対値更新処理が完了した際に、更新結果をWebhook通知するURLを入力します。</dd>
    </dl>

  <h3>出力</h3>
    <dl class="message-properties">
        <dt>payload <span class="property-type">オブジェクト</span></dt>
        <dd>選択した処理の実行結果を出力します。</dd>
    </dl>

  <h3>詳細</h3>
  <h4>在庫一覧取得</h4>
    <p>在庫情報一覧を取得します。</p>
    <p><code>msg.limit</code>に一度に返すアイテム数を1 〜 1000の範囲で入力します。</p>
    <p><code>msg.page</code>に取得する対象ページを入力します。</p>
    <p>取得した在庫情報一覧を出力します。</p>

  <h4>在庫更新</h4>
    <p>在庫情報を更新します。在庫数は、入力された値と同じになるよう更新します。</p>
    <p><code>msg.productId</code>に更新する商品IDを入力します。必須項目です。</p>
    <p><code>msg.storeId</code>に更新する店舗IDを入力します。必須項目です。</p>
    <p><code>msg.stockAmount</code>に在庫数を入力します。必須項目です。</p>
    <p>更新した在庫情報を出力します。</p>

  <h4>在庫相対値更新</h4>
    <p>在庫情報を更新します。在庫数は、現在の値に対し、入力された値を加算（入力値が負の場合は減算）した値に更新します。</p>
    <p><code>msg.productId</code>に更新する商品IDを入力します。必須項目です。</p>
    <p><code>msg.storeId</code>に更新する店舗IDを入力します。必須項目です。</p>
    <p><code>msg.stockAmount</code>に在庫数を入力します。必須項目です。</p>
    <p>更新した在庫情報を出力します。</p>

  <h4>在庫一括相対値更新</h4>
    <p>在庫情報を一括更新します。在庫数は、現在の値に対し、入力された値を加算（入力値が負の場合は減算）した値に更新します。</p>
    <p><code>msg.stocks</code>に更新する在庫情報を入力します。</p>
    <pre>[{
  "productId": "1234567",
  "storeId": "1",
  "stockAmount": 100
}]</pre>
    <p><code>msg.callbackUrl</code>に商品の更新が完了した際に、更新結果をWebhook通知するURLを入力します。</p>
    <p>Webhook通知するURLや問い合わせ用IDの情報を出力します。</p>

  <h4>在庫変動履歴取得</h4>
    <p>在庫変動履歴情報を取得します。</p>
    <p><code>msg.productId</code>に取得する商品IDを入力します。必須項目です。</p>
    <p><code>msg.storeId</code>に取得する店舗IDを入力します。必須項目です。</p>
    <p><code>msg.limit</code>に一度に返すアイテム数を1 〜 1000の範囲で入力します。</p>
    <p><code>msg.page</code>に取得する対象ページを入力します。</p>
    <p>取得した在庫変動履歴情報を出力します。</p>

  <p></p>
  <p><b>注</b>: 入力項目はノードの編集ダイアログでも入力可能ですが、<code>msg.xx</code>で渡された値が優先されます。</p>

<h3>参照</h3>
  <p>詳細は、<a href="https://www1.smaregi.dev/apidoc/#tag/%E5%9C%A8%E5%BA%AB">スマレジ・プラットフォームAPI POS仕様書</a>の在庫の各項を参照してください。</p>

</script>